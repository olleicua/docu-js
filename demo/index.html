<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>docu.js demo</title>
    <style type="text/css">
      body {
        background: #fcc;
        color: #417;
      }
    </style>
  </head>
  <body>
    <h2>example 1</h2>
    <div class="example-1"></div>
    <h2>example 2</h2>
    <div class="example-2"></div>
    <h2>example 3</h2>
    <div class="example-3"></div>
    <h2>example 4</h2>
    <div class="example-4"></div>
    <h2>example 5</h2>
    <div class="example-5"></div>
    <script src="../dist/docu.js"></script>
    <script>
      // create HTML elements
      const container = new docu.Entity({
        className: 'main-content',
        children: [
          new docu.Entity('p', {
            textContent: 'paragraph 1'
          }),
          new docu.Entity('p', {
            textContent: 'paragraph 2',
            style: { textDecoration: 'underline' }
          })
        ]
      });
      docu.append(document.querySelector('.example-1'), container);

      // listen to events
      const clicker = new docu.Listener();

      docu.append(
        document.querySelector('.example-2'),
        new docu.Entity('button', {
          textContent: 'click me',
          onClick: (event) => clicker.send(event)
        })
      );

      clicker.listen((event) => {
        console.log('the clicker recieved an event:', event);
      });

      // use dynamic state
      const name = new docu.State('world');

      const input = new docu.Entity('label', {
        children: [
          'name: ',
          new docu.Entity('input', {
            value: name.dynamicValue(),
            onKeyUp: (event) => name.set(event.target.value)
          })
        ]
      });
      docu.append(document.querySelector('.example-3'), input);

      const content = new docu.Entity('p', {
        children: [
          'hello ',
          new docu.Entity('span', {
            textContent: name.dynamicValue()
          })
        ]
      });
      docu.append(document.querySelector('.example-3'), content);

      // use dynamic state with a modifier function
      const numberOfCats = new docu.State(0);

      const input4 = new docu.Entity('label', {
        children: [
          'number of cats: ',
          new docu.Entity('input', {
            value: numberOfCats.dynamicValue(),
            type: 'number',
            onChange: (event) => numberOfCats.set(event.target.value)
          })
        ]
      });
      docu.append(document.querySelector('.example-4'), input4);

      const content4 = new docu.Entity('p', {
        textContent: numberOfCats.dynamicValue((n) => {
          return 'ðŸˆ'.repeat(n);
        }),
        style: { backgroundColor: '#417' }
      });
      docu.append(document.querySelector('.example-4'), content4);

      // dynamic children
      const contentOption = new docu.State('paragraph');

      const select = new docu.Entity('label', {
        children: [
          'type of content: ',
          new docu.Entity('select', {
            onChange: (event) => contentOption.set(event.target.value),
            children: [
              new docu.Entity('option', {
                value: 'paragraph',
                textContent: 'Paragraph',
                selected: contentOption.dynamicValue(v => v === 'paragraph')
              }),
              new docu.Entity('option', {
                value: 'image',
                textContent: 'Image',
                selected: contentOption.dynamicValue(v => v === 'image')
              })
            ]
          })
        ]
      });
      docu.append(document.querySelector('.example-5'), select);

      const content5 = new docu.Entity('p', {
        style: {
          border: '3px dashed #417',
          padding: '5px'
        },
        children: [
          'content:',
          new docu.Entity('br', {}),
          contentOption.dynamicValue((option) => {
            return {
              paragraph: new docu.Entity('p', { textContent: 'the cat is adorable' }),
              image: new docu.Entity('img', { src: '139.jpg' })
            }[option];
          })
        ]
      });
      docu.append(document.querySelector('.example-5'), content5);
    </script>
  </body>
</html>
